<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/signup.css" />
    <title>Sign Up Page</title>
  </head>
  <body>
    <!-- Sign Up EJS -->
    <div id="signup" class="overlay">
      <div class="external-window-container">
        <a href="/" id="signup-close-window-link">Back</a>
        <div class="signup-form">
          <div class="form-title">
            <h1 class="brandName form-brand">GoVote</h1>
            <h2>SIGN UP</h2>
            <p class="alert"><%= errorMsg %></p>
          </div>
          <form action="/signup" method="post">
            <label for="signupName">Name:</label>
            <input type="text" id="signupName" name="signupName" required />

            <label for="signupUsername">Username:</label>
            <input type="text" id="signupUsername" name="signupUsername" required />

            <label for="signupEmail">Email:</label>
            <input type="email" id="signupEmail" name="signupEmail" required />

            <label for="signupPassword">Password:</label>
            <input
              type="password"
              id="signupPassword"
              name="signupPassword"
              pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
              title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
              required
            />

            <label for="signupConfirmPassword">Confirm Password:</label>
            <input
              type="password"
              id="signupConfirmPassword"
              name="signupConfirmPassword"
              pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
              title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
              required
            />

            <button id="signupSubmit" type="submit">Sign Up</button>
          </form>
          <div id="message">
            <h4>Password must contain the following:</h4>
            <p id="letter" class="invalid">A <b>lowercase</b> letter</p>
            <p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
            <p id="number" class="invalid">A <b>number</b></p>
            <p id="length" class="invalid">Minimum <b>8 characters</b></p>
          </div>
          <p>Already have an account? <a href="/login" id="login-link">Log In</a> instead</p>
        </div>
      </div>
    </div>
    <script>
      let pass = document.getElementById("signupPassword");
      let cpass = document.getElementById("signupConfirmPassword");
      let letter = document.getElementById("letter");
      let capital = document.getElementById("capital");
      let number = document.getElementById("number");
      let length = document.getElementById("length");

      pass.onfocus = function () {
        document.getElementById("message").style.display = "block";
      };

      pass.onblur = function () {
        document.getElementById("message").style.display = "none";
      };

      pass.onkeyup = function () {
        var lowerCaseLetters = /[a-z]/g;
        if (pass.value.match(lowerCaseLetters)) {
          letter.classList.remove("invalid");
          letter.classList.add("valid");
        } else {
          letter.classList.remove("valid");
          letter.classList.add("invalid");
        }

        var upperCaseLetters = /[A-Z]/g;
        if (pass.value.match(upperCaseLetters)) {
          capital.classList.remove("invalid");
          capital.classList.add("valid");
        } else {
          capital.classList.remove("valid");
          capital.classList.add("invalid");
        }

        var numbers = /[0-9]/g;
        if (pass.value.match(numbers)) {
          number.classList.remove("invalid");
          number.classList.add("valid");
        } else {
          number.classList.remove("valid");
          number.classList.add("invalid");
        }

        if (pass.value.length >= 8) {
          length.classList.remove("invalid");
          length.classList.add("valid");
        } else {
          length.classList.remove("valid");
          length.classList.add("invalid");
        }
      };

      cpass.onfocus = function () {
        document.getElementById("message").style.display = "block";
      };

      cpass.onblur = function () {
        document.getElementById("message").style.display = "none";
      };

      cpass.onkeyup = function () {
        var lowerCaseLetters = /[a-z]/g;
        if (cpass.value.match(lowerCaseLetters)) {
          letter.classList.remove("invalid");
          letter.classList.add("valid");
        } else {
          letter.classList.remove("valid");
          letter.classList.add("invalid");
        }

        var upperCaseLetters = /[A-Z]/g;
        if (cpass.value.match(upperCaseLetters)) {
          capital.classList.remove("invalid");
          capital.classList.add("valid");
        } else {
          capital.classList.remove("valid");
          capital.classList.add("invalid");
        }

        var numbers = /[0-9]/g;
        if (cpass.value.match(numbers)) {
          number.classList.remove("invalid");
          number.classList.add("valid");
        } else {
          number.classList.remove("valid");
          number.classList.add("invalid");
        }

        if (cpass.value.length >= 8) {
          length.classList.remove("invalid");
          length.classList.add("valid");
        } else {
          length.classList.remove("valid");
          length.classList.add("invalid");
        }
      };
    </script>
  </body>
</html>
